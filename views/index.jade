extends inline_layout

block header
  title Blog

block content
  h1.main-title(align='center') Blog

  div#content
    each val in docs
      div.post
        div.post-heading
          div.post-title
            a(href='/#{val._id}') #{val.subject} - #{val.name}
          div.meta-text #{val.date}
        div.post-content
          pre #{val.content}
  div
    input.btn.btn-default#loadMorePosts(type='button' value='Load More Posts' onclick='load()')

  div.pull-right
    a(href='/feed')
      img(src='/images/rss.png' width=15)

block foot
  script
    function load(){
    $.getJSON('/json/morePosts', function(data){
        //alert('success' + data);
        if(data.error === 'There are no more posts'){
        $('#loadMorePosts').before('<div class="error">There are no more posts</div>');
        $('#loadMorePosts').remove();
        }
        else{
        for(var i = 0; i < data.length; i++){
            $('#loadMorePosts')
            .before($('<div class="post"></div>')
                .append($('<div class="post-heading"></div>')
                .append($('<div class="post-title"></div>')
                    .append('<a href=/' + data[i].id + '>' + data[i].subject + ' - ' + data[i].name + '</a>'))
                .append($('<div class="post-date"></div>')
                    .append(data[i].date)))
                .append($('<div class="post-content"></div>')
                .append($('<pre></pre>')
                    .append(data[i].content)))
            );
        }
        }
    });
    }
